# Custom Tags

Create your own tags using JavaScript, Python, Groovy, Java, or AI prompts.

## Creating a Custom Tag

1. Go to **Hackvertor menu → Create custom tag**
2. Enter a tag name (alphanumeric, no spaces)
3. Select a language
4. Write your code
5. Click "Create tag"

## Supported Languages

| Language | Engine | Notes |
|----------|--------|-------|
| JavaScript | GraalJS | Full ES6+ support |
| Python | Jython | Python 2.7 syntax |
| Groovy | GroovyShell | Java interop |
| Java | BeanShell | Java syntax |
| AI | Burp AI | Natural language prompts |

## Code Structure

Your code receives the input as a variable and must return the output.

### JavaScript

```javascript
// 'input' contains the tag content
// Return the result
output = input.split('').reverse().join('');
```

### Python

```python
# 'input' contains the tag content
# Set 'output' to the result
output = input[::-1]
```

### Groovy

```groovy
// 'input' contains the tag content
// Return the result
output = input.reverse()
```

### Java (BeanShell)

```java
// 'input' contains the tag content
// Set 'output' to the result
output = new StringBuilder(input).reverse().toString();
```

## Tag Arguments

Custom tags can accept up to 2 arguments.

When creating a tag:
1. Set "Number of arguments" to 1 or 2
2. Define argument types (String or Number)
3. Access via their assigned names

Example with one argument (Param Name is `param1`):

```javascript
// Tag: repeat_custom
// Argument 1: Number
var count = param1 || 1;
output = input.repeat(count);
```

Usage: `<@repeat_custom(3)>abc</@repeat_custom>` → `abcabcabc`

## Managing Custom Tags

### List Tags
**Hackvertor menu → List custom tags**

Shows all custom tags with options to edit or delete.

### Edit a Tag
1. Open "List custom tags"
2. Select the tag
3. Click "Edit tag"
4. Modify and save

### Delete a Tag
1. Open "List custom tags"
2. Select the tag
3. Click "Delete tag"

## Export to Tag Store

Share your tags with the community:

1. Open "List custom tags"
2. Select your tag
3. Click "Export to tag store"

This creates the files needed for a GitHub PR to the Hackvertor tag-store.

## Examples

### Base62 Encode (Python)

```python
import string
chars = string.digits + string.ascii_letters
result = ''
n = int(input.encode('utf-8').hex(), 16)
while n > 0:
    n, r = divmod(n, 62)
    result = chars[r] + result
output = result
```

### JSON Pretty Print (JavaScript)

```javascript
try {
    output = JSON.stringify(JSON.parse(input), null, 2);
} catch(e) {
    output = "Invalid JSON: " + e.message;
}
```

### TOTP Generator (Python)

```python
import hmac
import hashlib
import struct
import time

secret = param1  # Base32 encoded secret
interval = 30
t = int(time.time() // interval)
key = base64.b32decode(secret.upper())
msg = struct.pack('>Q', t)
h = hmac.new(key, msg, hashlib.sha1).digest()
o = h[-1] & 0x0f
code = struct.unpack('>I', h[o:o+4])[0] & 0x7fffffff
output = str(code % 1000000).zfill(6)
```

## Permissions

Custom code tags require **"Allow code execution tags"** to be enabled in Settings.

**Warning**: Only enable this for trusted code. Malicious tags could compromise your system.

## Python Module Path

For Python tags needing external modules:
1. Go to **Hackvertor → Settings → System**
2. Set "Python module path" to your modules directory

## Tag Execution Key

Code tags require a tag execution key for security. This key is generated by Hackvertor when tags are inserted and will appear as the final parameter in functions calls. 

